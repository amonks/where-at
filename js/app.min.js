function initialize(){var o={disableDefaultUI:!0,panControl:!1,zoomControl:!1,zoom:10,mapTypeControl:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}};map=new google.maps.Map(document.getElementById("map-canvas"),o);var e={map:map,buttonLabelHtml:"Share"};drawingManager.setMap(map);new SnapShotControl(e);google.maps.event.addListener(drawingManager,"overlaycomplete",function(o){var e=o.type+"";switch(o.type){case google.maps.drawing.OverlayType.MARKER:e+=o.overlay.getPosition()+"",constructMarker(e);break;case google.maps.drawing.OverlayType.RECTANGLE:e+=o.overlay.getBounds()+"";break;case google.maps.drawing.OverlayType.CIRCLE:e+=o.overlay.getCenter()+"",e+=o.overlay.getRadius()+"";break;default:path=o.overlay.getPath();for(var a=0;a<path.length;a++)e+=path.getAt(a)+";";constructPolyline(e)}console.log(e),save.add(e)}),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(o){var e=new google.maps.LatLng(o.coords.latitude,o.coords.longitude);map.setCenter(e)},function(){handleNoGeolocation(!0)}):handleNoGeolocation(!1);var a=[],n=document.getElementById("pac-input");map.controls[google.maps.ControlPosition.TOP_LEFT].push(n);var t=new google.maps.places.SearchBox(n);google.maps.event.addListener(t,"places_changed",function(){for(var o,e=t.getPlaces(),n=0;o=a[n];n++)o.setMap(null);a=[];for(var r,n=(new google.maps.LatLngBounds,0);r=e[n];n++){var l={url:r.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},o=new google.maps.Marker({map:map,icon:l,title:r.name,position:r.geometry.location});a.push(o),r.geometry.viewport?map.fitBounds(r.geometry.viewport):(map.setCenter(r.geometry.location),map.setZoom(17))}}),google.maps.event.addListener(map,"bounds_changed",function(){var o=map.getBounds();t.setBounds(o)})}function handleNoGeolocation(o){if(o)var e="Error: Couldn't find your location.";else var e="Error: Your browser doesn't support geolocation.";{var a={map:map,position:new google.maps.LatLng(41.880454799999995,-87.6251393),content:e};new google.maps.InfoWindow(a)}map.setCenter(a.position)}function randomColor(){return"#"+Math.floor(16777215*Math.random()).toString(16)}function saveImage(){$("body").html2canvas();var o=html2canvas.Parse(),e=html2canvas.Renderer(o,{elements:{length:1}}),a=e.toDataURL();window.open(a)}function SaveData(){this.drawLog=""}function constructPolyline(o){var e,a=o.replace("polyline","").replace(/\(/g,"").replace(/\)/g,"").split(";");console.log(a);for(var n=new google.maps.MVCArray,t=a.length-2;t>=0;t--){console.log(a[t].split(", "));var e=a[t].split(", ");n.push(new google.maps.LatLng(parseFloat(e[0]),parseFloat(e[1])))}new google.maps.Polyline({path:n,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:5,map:map})}function constructMarker(o){var e=o.replace("marker","").replace(/\(/g,"").replace(/\)/g,"").split(", "),a=new google.maps.MVCArray;a.push(new google.maps.LatLng(parseFloat(e[0]),parseFloat(e[1]))),a.forEach(function(o){createMarker({map:map,position:o})})}function createMarker(o){var e=new google.maps.Marker(o);return google.maps.event.addListenerOnce(e,"click",function(){e.setMap(null),e=null}),e}function getQueryString(){if(-1==window.location.href.indexOf("?"))return null;var o=window.location.href.slice(window.location.href.indexOf("?")+1);return o.length<=1?null:atob(o)}var save=new SaveData,map,drawingManager=new google.maps.drawing.DrawingManager({drawingMode:google.maps.drawing.OverlayType.POLYLINE,drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_LEFT,drawingModes:[google.maps.drawing.OverlayType.POLYLINE,google.maps.drawing.OverlayType.MARKER]},polylineOptions:{strokeWeight:5,strokeOpacity:.5,strokeColor:"#ff0000",clickable:!1,zIndex:1,editable:!1},polygonOptions:{editable:!1},markerOptions:{editable:!1}});SaveData.prototype.base64=function(){return btoa(this.drawLog)},SaveData.prototype.add=function(o){this.drawLog+=o},google.maps.event.addDomListener(window,"load",initialize);