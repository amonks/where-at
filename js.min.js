function initialize(){var e={disableDefaultUI:!0,panControl:!1,zoomControl:!1,zoom:10,mapTypeControl:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}};map=new google.maps.Map(document.getElementById("map-canvas"),e),draw(),search(),saveControl(),clearControl();var t={map:map,position:new google.maps.LatLng(41.880454799999995,-87.6251393)};map.setCenter(t.position),load()}function clearControl(){var e=document.createElement("div");new ClearControl(e,map),e.index=1,map.controls[google.maps.ControlPosition.BOTTOM_LEFT].push(e)}function ClearControl(e){e.style.padding="5px";var t=document.createElement("div");t.style.backgroundColor="white",t.style.borderStyle="solid",t.style.borderWidth="2px",t.style.cursor="pointer",t.style.textAlign="center",t.title="Click to set the map to Home",e.appendChild(t);var o=document.createElement("div");o.style.fontFamily="Arial,sans-serif",o.style.fontSize="12px",o.style.paddingLeft="4px",o.style.paddingRight="4px",o.innerHTML="<b>Clear</b>",t.appendChild(o),google.maps.event.addDomListener(t,"click",function(){window.location=window.location.href.split("?")[0]})}function draw(){drawingManager.setMap(map),google.maps.event.addListener(drawingManager,"overlaycomplete",function(e){switch(output="",e.type){case google.maps.drawing.OverlayType.MARKER:output=output+"m"+(e.overlay.getPosition()+""),constructMarker(output);break;default:path=e.overlay.getPath(),output+="p";for(var t=0;path.length>t;t++)output+=path.getAt(t)+";";constructPolyline(output)}output=output.replace(/\(/g,"").replace(/\)/g,"").replace(" ",""),console.log(output),save.add(output)})}function constructPolyline(e){for(var t,o=e.replace("p","").replace(/\(/g,"").replace(/\)/g,"").split(";"),r=new google.maps.MVCArray,a=o.length-2;a>=0;a--){var t=o[a].split(",");r.push(new google.maps.LatLng(parseFloat(t[0]),parseFloat(t[1])))}new google.maps.Polyline({path:r,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:5,map:map})}function constructMarker(e){var t=e.replace("m","").replace(/\(/g,"").replace(/\)/g,"").split(","),o=new google.maps.MVCArray;o.push(new google.maps.LatLng(parseFloat(t[0]),parseFloat(t[1]))),o.forEach(function(e){createMarker({map:map,position:e})})}function createMarker(e){var t=new google.maps.Marker(e);return google.maps.event.addListenerOnce(t,"click",function(){t.setMap(null),t=null}),t}function constructZoom(e){var t=e.replace("z","").replace(/\(/g,"").replace(/\)/g,"");map.setZoom(parseInt(t))}function constructCenter(e){var t=e.replace("c","").replace(/\(/g,"").replace(/\)/g,""),o=t.split(", ");map.setCenter(new google.maps.LatLng(parseFloat(o[0]),parseFloat(o[1])))}function getQueryString(){if(-1==window.location.href.indexOf("?"))return null;var e=window.location.href.slice(window.location.href.indexOf("?")+1);return 1>=e.length?null:atob(decompressFromUTF16(e))}function getOverlayArray(){return getQueryString().split("|")}function load(){if(null!==getQueryString())for(var e=getOverlayArray(),t=e.length-1;t>=0;t--)console.log(e[t]),-1!==e[t].indexOf("z")&&constructZoom(e[t]),-1!==e[t].indexOf("c")&&constructCenter(e[t]),-1!==e[t].indexOf("p")&&(constructPolyline(e[t]),save.add(e[t])),-1!==e[t].indexOf("m")&&(constructMarker(e[t]),save.add(e[t]))}function SaveData(){this.drawLog=[]}function saveControl(){var e=document.createElement("div");new SaveControl(e,map),e.index=1,map.controls[google.maps.ControlPosition.BOTTOM_LEFT].push(e)}function SaveControl(e){e.style.padding="5px";var t=document.createElement("div");t.style.backgroundColor="white",t.style.borderStyle="solid",t.style.borderWidth="2px",t.style.cursor="pointer",t.style.textAlign="center",t.title="Click to set the map to Home",e.appendChild(t);var o=document.createElement("div");o.style.fontFamily="Arial,sans-serif",o.style.fontSize="12px",o.style.paddingLeft="4px",o.style.paddingRight="4px",o.innerHTML="<b>Share</b>",t.appendChild(o),google.maps.event.addDomListener(t,"click",function(){save.save()})}function search(){var e=[],t=document.getElementById("pac-input");map.controls[google.maps.ControlPosition.TOP_LEFT].push(t);var o=new google.maps.places.SearchBox(t);google.maps.event.addListener(o,"places_changed",function(){for(var t,r=o.getPlaces(),a=0;t=e[a];a++)t.setMap(null);e=[],new google.maps.LatLngBounds;for(var n,a=0;n=r[a];a++){var i={url:n.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},t=new google.maps.Marker({map:map,icon:i,title:n.name,position:n.geometry.location});e.push(t),n.geometry.viewport?map.fitBounds(n.geometry.viewport):(map.setCenter(n.geometry.location),map.setZoom(17))}}),google.maps.event.addListener(map,"bounds_changed",function(){var e=map.getBounds();o.setBounds(e)}),{map:map,position:new google.maps.LatLng(41.880454799999995,-87.6251393)}}var map,drawingManager=new google.maps.drawing.DrawingManager({drawingMode:google.maps.drawing.OverlayType.POLYLINE,drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_LEFT,drawingModes:[google.maps.drawing.OverlayType.POLYLINE,google.maps.drawing.OverlayType.MARKER]},polylineOptions:{strokeWeight:5,strokeOpacity:.5,strokeColor:"#ff0000",clickable:!1,zIndex:1,editable:!1},polygonOptions:{editable:!1},markerOptions:{editable:!1}});(function(e){var t=!1,o=!1;e.getScript("https://apis.google.com/js/client.js",function(){(function r(){gapi.client?(t=!0,gapi.client.setApiKey(e.urlShortener.settings.apiKey),gapi.client.load("urlshortener",e.urlShortener.settings.version,function(){o=!0})):window.setTimeout(r,10)})()}),e.urlShortener=function(r){function a(e){var t={longUrl:e.longUrl},o=gapi.client.urlshortener.url.insert({resource:t});o.execute(function(t){null!=t.id?e.success&&e.success.call(this,t.id):e.error&&e.error.call(this,t.error)})}function n(e){var t={shortUrl:e.shortUrl,projection:e.projection},o=gapi.client.urlshortener.url.get(t);o.execute(function(t){null!=t.longUrl?e.success&&(void 0==e.projection?e.success.call(this,t.longUrl):e.success.call(this,t)):e.error&&e.error.call(this,t.error)})}var i={};e.extend(i,e.urlShortener.settings,r),function s(){t&&o?void 0!=i.longUrl?a(i):void 0!=i.shortUrl&&n(i):window.setTimeout(s,10)}()},e.urlShortener.settings={apiKey:"AIzaSyDIPa8VjR1Iybo-vl60dd3CpSmw2zyMfvA",version:"v1"}})(jQuery);var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(null==e)return"";var t,o,r,a,n,i,s,l="",c=0;for(e=LZString.compress(e);2*e.length>c;)0==c%2?(t=e.charCodeAt(c/2)>>8,o=255&e.charCodeAt(c/2),r=e.length>c/2+1?e.charCodeAt(c/2+1)>>8:0/0):(t=255&e.charCodeAt((c-1)/2),e.length>(c+1)/2?(o=e.charCodeAt((c+1)/2)>>8,r=255&e.charCodeAt((c+1)/2)):o=r=0/0),c+=3,a=t>>2,n=(3&t)<<4|o>>4,i=(15&o)<<2|r>>6,s=63&r,isNaN(o)?i=s=64:isNaN(r)&&(s=64),l=l+LZString._keyStr.charAt(a)+LZString._keyStr.charAt(n)+LZString._keyStr.charAt(i)+LZString._keyStr.charAt(s);return l},decompressFromBase64:function(e){if(null==e)return"";var t,o,r,a,n,i,s,l,c="",p=0,g=0,d=LZString._f;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");e.length>g;)n=LZString._keyStr.indexOf(e.charAt(g++)),i=LZString._keyStr.indexOf(e.charAt(g++)),s=LZString._keyStr.indexOf(e.charAt(g++)),l=LZString._keyStr.indexOf(e.charAt(g++)),o=n<<2|i>>4,r=(15&i)<<4|s>>2,a=(3&s)<<6|l,0==p%2?(t=o<<8,64!=s&&(c+=d(t|r)),64!=l&&(t=a<<8)):(c+=d(t|o),64!=s&&(t=r<<8),64!=l&&(c+=d(t|a))),p+=3;return LZString.decompress(c)},compressToUTF16:function(e){if(null==e)return"";var t,o,r,a="",n=0,i=LZString._f;for(e=LZString.compress(e),t=0;e.length>t;t++)switch(o=e.charCodeAt(t),n++){case 0:a+=i((o>>1)+32),r=(1&o)<<14;break;case 1:a+=i(r+(o>>2)+32),r=(3&o)<<13;break;case 2:a+=i(r+(o>>3)+32),r=(7&o)<<12;break;case 3:a+=i(r+(o>>4)+32),r=(15&o)<<11;break;case 4:a+=i(r+(o>>5)+32),r=(31&o)<<10;break;case 5:a+=i(r+(o>>6)+32),r=(63&o)<<9;break;case 6:a+=i(r+(o>>7)+32),r=(127&o)<<8;break;case 7:a+=i(r+(o>>8)+32),r=(255&o)<<7;break;case 8:a+=i(r+(o>>9)+32),r=(511&o)<<6;break;case 9:a+=i(r+(o>>10)+32),r=(1023&o)<<5;break;case 10:a+=i(r+(o>>11)+32),r=(2047&o)<<4;break;case 11:a+=i(r+(o>>12)+32),r=(4095&o)<<3;break;case 12:a+=i(r+(o>>13)+32),r=(8191&o)<<2;break;case 13:a+=i(r+(o>>14)+32),r=(16383&o)<<1;break;case 14:a+=i(r+(o>>15)+32,(32767&o)+32),n=0}return a+i(r+32)},decompressFromUTF16:function(e){if(null==e)return"";for(var t,o,r="",a=0,n=0,i=LZString._f;e.length>n;){switch(o=e.charCodeAt(n)-32,a++){case 0:t=o<<1;break;case 1:r+=i(t|o>>14),t=(16383&o)<<2;break;case 2:r+=i(t|o>>13),t=(8191&o)<<3;break;case 3:r+=i(t|o>>12),t=(4095&o)<<4;break;case 4:r+=i(t|o>>11),t=(2047&o)<<5;break;case 5:r+=i(t|o>>10),t=(1023&o)<<6;break;case 6:r+=i(t|o>>9),t=(511&o)<<7;break;case 7:r+=i(t|o>>8),t=(255&o)<<8;break;case 8:r+=i(t|o>>7),t=(127&o)<<9;break;case 9:r+=i(t|o>>6),t=(63&o)<<10;break;case 10:r+=i(t|o>>5),t=(31&o)<<11;break;case 11:r+=i(t|o>>4),t=(15&o)<<12;break;case 12:r+=i(t|o>>3),t=(7&o)<<13;break;case 13:r+=i(t|o>>2),t=(3&o)<<14;break;case 14:r+=i(t|o>>1),t=(1&o)<<15;break;case 15:r+=i(t|o),a=0}n++}return LZString.decompress(r)},compress:function(e){if(null==e)return"";var t,o,r,a={},n={},i="",s="",l="",c=2,p=3,g=2,d="",u=0,f=0,m=LZString._f;for(r=0;e.length>r;r+=1)if(i=e.charAt(r),Object.prototype.hasOwnProperty.call(a,i)||(a[i]=p++,n[i]=!0),s=l+i,Object.prototype.hasOwnProperty.call(a,s))l=s;else{if(Object.prototype.hasOwnProperty.call(n,l)){if(256>l.charCodeAt(0)){for(t=0;g>t;t++)u<<=1,15==f?(f=0,d+=m(u),u=0):f++;for(o=l.charCodeAt(0),t=0;8>t;t++)u=u<<1|1&o,15==f?(f=0,d+=m(u),u=0):f++,o>>=1}else{for(o=1,t=0;g>t;t++)u=u<<1|o,15==f?(f=0,d+=m(u),u=0):f++,o=0;for(o=l.charCodeAt(0),t=0;16>t;t++)u=u<<1|1&o,15==f?(f=0,d+=m(u),u=0):f++,o>>=1}c--,0==c&&(c=Math.pow(2,g),g++),delete n[l]}else for(o=a[l],t=0;g>t;t++)u=u<<1|1&o,15==f?(f=0,d+=m(u),u=0):f++,o>>=1;c--,0==c&&(c=Math.pow(2,g),g++),a[s]=p++,l=i+""}if(""!==l){if(Object.prototype.hasOwnProperty.call(n,l)){if(256>l.charCodeAt(0)){for(t=0;g>t;t++)u<<=1,15==f?(f=0,d+=m(u),u=0):f++;for(o=l.charCodeAt(0),t=0;8>t;t++)u=u<<1|1&o,15==f?(f=0,d+=m(u),u=0):f++,o>>=1}else{for(o=1,t=0;g>t;t++)u=u<<1|o,15==f?(f=0,d+=m(u),u=0):f++,o=0;for(o=l.charCodeAt(0),t=0;16>t;t++)u=u<<1|1&o,15==f?(f=0,d+=m(u),u=0):f++,o>>=1}c--,0==c&&(c=Math.pow(2,g),g++),delete n[l]}else for(o=a[l],t=0;g>t;t++)u=u<<1|1&o,15==f?(f=0,d+=m(u),u=0):f++,o>>=1;c--,0==c&&(c=Math.pow(2,g),g++)}for(o=2,t=0;g>t;t++)u=u<<1|1&o,15==f?(f=0,d+=m(u),u=0):f++,o>>=1;for(;;){if(u<<=1,15==f){d+=m(u);break}f++}return d},decompress:function(e){if(null==e)return"";if(""==e)return null;var t,o,r,a,n,i,s,l,c=[],p=4,g=4,d=3,u="",f="",m=LZString._f,h={string:e,val:e.charCodeAt(0),position:32768,index:1};for(o=0;3>o;o+=1)c[o]=o;for(a=0,i=Math.pow(2,2),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;switch(t=a){case 0:for(a=0,i=Math.pow(2,8),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;l=m(a);break;case 1:for(a=0,i=Math.pow(2,16),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;l=m(a);break;case 2:return""}for(c[3]=l,r=f=l;;){if(h.index>h.string.length)return"";for(a=0,i=Math.pow(2,d),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;switch(l=a){case 0:for(a=0,i=Math.pow(2,8),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;c[g++]=m(a),l=g-1,p--;break;case 1:for(a=0,i=Math.pow(2,16),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;c[g++]=m(a),l=g-1,p--;break;case 2:return f}if(0==p&&(p=Math.pow(2,d),d++),c[l])u=c[l];else{if(l!==g)return null;u=r+r.charAt(0)}f+=u,c[g++]=r+u.charAt(0),p--,r=u,0==p&&(p=Math.pow(2,d),d++)}}};"undefined"!=typeof module&&null!=module&&(module.exports=LZString);var save=new SaveData;SaveData.prototype.save=function(){console.log(this.base64()),longUrl=window.location.href.split("?")[0]+"?"+this.base64(),jQuery.urlShortener({longUrl:longUrl,success:function(e){alert(e),console.log(e),window.location=e},error:function(e){alert(JSON.stringify(e))}})},SaveData.prototype.base64=function(){return btoa(LZString.compressToUTF16(this.metadata()+this.drawLog.join("|")))},SaveData.prototype.metadata=function(){var e="";return e+="z"+map.zoom+"|",e+="c"+(""+map.getCenter())+"|"},SaveData.prototype.add=function(e){this.drawLog.push(e)},google.maps.event.addDomListener(window,"load",initialize);