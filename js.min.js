function initialize(){var e={disableDefaultUI:!0,panControl:!1,zoomControl:!1,zoom:10,mapTypeControl:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}};map=new google.maps.Map(document.getElementById("map-canvas"),e),draw(),search(),saveControl(),clearControl();var o={map:map,position:new google.maps.LatLng(41.880454799999995,-87.6251393)};map.setCenter(o.position),load()}function clearControl(){var e=document.createElement("div");new ClearControl(e,map),e.index=1,map.controls[google.maps.ControlPosition.BOTTOM_LEFT].push(e)}function ClearControl(e){e.style.padding="5px";var o=document.createElement("div");o.style.backgroundColor="white",o.style.borderStyle="solid",o.style.borderWidth="2px",o.style.cursor="pointer",o.style.textAlign="center",o.title="Click to set the map to Home",e.appendChild(o);var t=document.createElement("div");t.style.fontFamily="Arial,sans-serif",t.style.fontSize="12px",t.style.paddingLeft="4px",t.style.paddingRight="4px",t.innerHTML="<b>Clear</b>",o.appendChild(t),google.maps.event.addDomListener(o,"click",function(){window.location=window.location.href.split("?")[0]})}function draw(){drawingManager.setMap(map),google.maps.event.addListener(drawingManager,"overlaycomplete",function(e){switch(output="",e.type){case google.maps.drawing.OverlayType.MARKER:output="m"+(e.overlay.getPosition()+""),constructMarker(output);break;default:path=e.overlay.getPath();var o=google.maps.geometry.encoding.encodePath(path);output="p"+o}output=output.replace(/\(/g,"").replace(/\)/g,"").replace(" ",""),console.log(output),save.add(output)})}function constructPolyline(e){e=e.replace(/^p/g,""),console.log(e);var o=google.maps.geometry.encoding.decodePath(e);console.log(""+o),new google.maps.Polyline({path:o,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:5,map:map})}function constructMarker(e){var o=e.replace("m","").replace(/\(/g,"").replace(/\)/g,"").split(","),t=new google.maps.MVCArray;t.push(new google.maps.LatLng(parseFloat(o[0]),parseFloat(o[1]))),t.forEach(function(e){createMarker({map:map,position:e})})}function createMarker(e){var o=new google.maps.Marker(e);return google.maps.event.addListenerOnce(o,"click",function(){o.setMap(null),o=null}),o}function constructZoom(e){var o=e.replace("z","").replace(/\(/g,"").replace(/\)/g,"");map.setZoom(parseInt(o))}function constructCenter(e){var o=e.replace("c","").replace(/\(/g,"").replace(/\)/g,""),t=o.split(",");map.setCenter(new google.maps.LatLng(parseFloat(t[0]),parseFloat(t[1])))}function getQueryString(){if(-1==window.location.href.indexOf("?"))return null;var e=window.location.href.slice(window.location.href.indexOf("?")+1);return 1>=e.length?null:LZString.decompressFromBase64(e)}function getOverlayArray(){return getQueryString().split(":")}function load(){if(null!==getQueryString()){var e=getOverlayArray();console.log(e);for(var o=e.length-1;o>=0;o--)console.log(e[o]),-1!==e[o].indexOf("z")&&constructZoom(e[o]),-1!==e[o].indexOf("c")&&constructCenter(e[o]),-1!==e[o].indexOf("p")&&(constructPolyline(e[o]),save.add(e[o])),-1!==e[o].indexOf("m")&&(constructMarker(e[o]),save.add(e[o]))}}function SaveData(){this.drawLog=[]}function saveControl(){var e=document.createElement("div");new SaveControl(e,map),e.index=1,map.controls[google.maps.ControlPosition.BOTTOM_LEFT].push(e)}function SaveControl(e){e.style.padding="5px";var o=document.createElement("div");o.style.backgroundColor="white",o.style.borderStyle="solid",o.style.borderWidth="2px",o.style.cursor="pointer",o.style.textAlign="center",o.title="Click to set the map to Home",e.appendChild(o);var t=document.createElement("div");t.style.fontFamily="Arial,sans-serif",t.style.fontSize="12px",t.style.paddingLeft="4px",t.style.paddingRight="4px",t.innerHTML="<b>Share</b>",o.appendChild(t),google.maps.event.addDomListener(o,"click",function(){save.save()})}function search(){var e=[],o=document.getElementById("pac-input");map.controls[google.maps.ControlPosition.TOP_LEFT].push(o);var t=new google.maps.places.SearchBox(o);google.maps.event.addListener(t,"places_changed",function(){for(var o,r=t.getPlaces(),a=0;o=e[a];a++)o.setMap(null);e=[],new google.maps.LatLngBounds;for(var n,a=0;n=r[a];a++){var i={url:n.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},o=new google.maps.Marker({map:map,icon:i,title:n.name,position:n.geometry.location});e.push(o),n.geometry.viewport?map.fitBounds(n.geometry.viewport):(map.setCenter(n.geometry.location),map.setZoom(17))}}),google.maps.event.addListener(map,"bounds_changed",function(){var e=map.getBounds();t.setBounds(e)}),{map:map,position:new google.maps.LatLng(41.880454799999995,-87.6251393)}}var map,drawingManager=new google.maps.drawing.DrawingManager({drawingMode:google.maps.drawing.OverlayType.POLYLINE,drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_LEFT,drawingModes:[google.maps.drawing.OverlayType.POLYLINE,google.maps.drawing.OverlayType.MARKER]},polylineOptions:{strokeWeight:5,strokeOpacity:.5,strokeColor:"#ff0000",clickable:!1,zIndex:1,editable:!1},polygonOptions:{editable:!1},markerOptions:{editable:!1}});(function(e){var o=!1,t=!1;e.getScript("https://apis.google.com/js/client.js",function(){(function r(){gapi.client?(o=!0,gapi.client.setApiKey(e.urlShortener.settings.apiKey),gapi.client.load("urlshortener",e.urlShortener.settings.version,function(){t=!0})):window.setTimeout(r,10)})()}),e.urlShortener=function(r){function a(e){var o={longUrl:e.longUrl},t=gapi.client.urlshortener.url.insert({resource:o});t.execute(function(o){null!=o.id?e.success&&e.success.call(this,o.id):e.error&&e.error.call(this,o.error)})}function n(e){var o={shortUrl:e.shortUrl,projection:e.projection},t=gapi.client.urlshortener.url.get(o);t.execute(function(o){null!=o.longUrl?e.success&&(void 0==e.projection?e.success.call(this,o.longUrl):e.success.call(this,o)):e.error&&e.error.call(this,o.error)})}var i={};e.extend(i,e.urlShortener.settings,r),function s(){o&&t?void 0!=i.longUrl?a(i):void 0!=i.shortUrl&&n(i):window.setTimeout(s,10)}()},e.urlShortener.settings={apiKey:"AIzaSyDIPa8VjR1Iybo-vl60dd3CpSmw2zyMfvA",version:"v1"}})(jQuery);var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(null==e)return"";var o,t,r,a,n,i,s,l="",c=0;for(e=LZString.compress(e);2*e.length>c;)0==c%2?(o=e.charCodeAt(c/2)>>8,t=255&e.charCodeAt(c/2),r=e.length>c/2+1?e.charCodeAt(c/2+1)>>8:0/0):(o=255&e.charCodeAt((c-1)/2),e.length>(c+1)/2?(t=e.charCodeAt((c+1)/2)>>8,r=255&e.charCodeAt((c+1)/2)):t=r=0/0),c+=3,a=o>>2,n=(3&o)<<4|t>>4,i=(15&t)<<2|r>>6,s=63&r,isNaN(t)?i=s=64:isNaN(r)&&(s=64),l=l+LZString._keyStr.charAt(a)+LZString._keyStr.charAt(n)+LZString._keyStr.charAt(i)+LZString._keyStr.charAt(s);return l},decompressFromBase64:function(e){if(null==e)return"";var o,t,r,a,n,i,s,l,c="",p=0,g=0,d=LZString._f;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");e.length>g;)n=LZString._keyStr.indexOf(e.charAt(g++)),i=LZString._keyStr.indexOf(e.charAt(g++)),s=LZString._keyStr.indexOf(e.charAt(g++)),l=LZString._keyStr.indexOf(e.charAt(g++)),t=n<<2|i>>4,r=(15&i)<<4|s>>2,a=(3&s)<<6|l,0==p%2?(o=t<<8,64!=s&&(c+=d(o|r)),64!=l&&(o=a<<8)):(c+=d(o|t),64!=s&&(o=r<<8),64!=l&&(c+=d(o|a))),p+=3;return LZString.decompress(c)},compressToUTF16:function(e){if(null==e)return"";var o,t,r,a="",n=0,i=LZString._f;for(e=LZString.compress(e),o=0;e.length>o;o++)switch(t=e.charCodeAt(o),n++){case 0:a+=i((t>>1)+32),r=(1&t)<<14;break;case 1:a+=i(r+(t>>2)+32),r=(3&t)<<13;break;case 2:a+=i(r+(t>>3)+32),r=(7&t)<<12;break;case 3:a+=i(r+(t>>4)+32),r=(15&t)<<11;break;case 4:a+=i(r+(t>>5)+32),r=(31&t)<<10;break;case 5:a+=i(r+(t>>6)+32),r=(63&t)<<9;break;case 6:a+=i(r+(t>>7)+32),r=(127&t)<<8;break;case 7:a+=i(r+(t>>8)+32),r=(255&t)<<7;break;case 8:a+=i(r+(t>>9)+32),r=(511&t)<<6;break;case 9:a+=i(r+(t>>10)+32),r=(1023&t)<<5;break;case 10:a+=i(r+(t>>11)+32),r=(2047&t)<<4;break;case 11:a+=i(r+(t>>12)+32),r=(4095&t)<<3;break;case 12:a+=i(r+(t>>13)+32),r=(8191&t)<<2;break;case 13:a+=i(r+(t>>14)+32),r=(16383&t)<<1;break;case 14:a+=i(r+(t>>15)+32,(32767&t)+32),n=0}return a+i(r+32)},decompressFromUTF16:function(e){if(null==e)return"";for(var o,t,r="",a=0,n=0,i=LZString._f;e.length>n;){switch(t=e.charCodeAt(n)-32,a++){case 0:o=t<<1;break;case 1:r+=i(o|t>>14),o=(16383&t)<<2;break;case 2:r+=i(o|t>>13),o=(8191&t)<<3;break;case 3:r+=i(o|t>>12),o=(4095&t)<<4;break;case 4:r+=i(o|t>>11),o=(2047&t)<<5;break;case 5:r+=i(o|t>>10),o=(1023&t)<<6;break;case 6:r+=i(o|t>>9),o=(511&t)<<7;break;case 7:r+=i(o|t>>8),o=(255&t)<<8;break;case 8:r+=i(o|t>>7),o=(127&t)<<9;break;case 9:r+=i(o|t>>6),o=(63&t)<<10;break;case 10:r+=i(o|t>>5),o=(31&t)<<11;break;case 11:r+=i(o|t>>4),o=(15&t)<<12;break;case 12:r+=i(o|t>>3),o=(7&t)<<13;break;case 13:r+=i(o|t>>2),o=(3&t)<<14;break;case 14:r+=i(o|t>>1),o=(1&t)<<15;break;case 15:r+=i(o|t),a=0}n++}return LZString.decompress(r)},compress:function(e){if(null==e)return"";var o,t,r,a={},n={},i="",s="",l="",c=2,p=3,g=2,d="",u=0,m=0,f=LZString._f;for(r=0;e.length>r;r+=1)if(i=e.charAt(r),Object.prototype.hasOwnProperty.call(a,i)||(a[i]=p++,n[i]=!0),s=l+i,Object.prototype.hasOwnProperty.call(a,s))l=s;else{if(Object.prototype.hasOwnProperty.call(n,l)){if(256>l.charCodeAt(0)){for(o=0;g>o;o++)u<<=1,15==m?(m=0,d+=f(u),u=0):m++;for(t=l.charCodeAt(0),o=0;8>o;o++)u=u<<1|1&t,15==m?(m=0,d+=f(u),u=0):m++,t>>=1}else{for(t=1,o=0;g>o;o++)u=u<<1|t,15==m?(m=0,d+=f(u),u=0):m++,t=0;for(t=l.charCodeAt(0),o=0;16>o;o++)u=u<<1|1&t,15==m?(m=0,d+=f(u),u=0):m++,t>>=1}c--,0==c&&(c=Math.pow(2,g),g++),delete n[l]}else for(t=a[l],o=0;g>o;o++)u=u<<1|1&t,15==m?(m=0,d+=f(u),u=0):m++,t>>=1;c--,0==c&&(c=Math.pow(2,g),g++),a[s]=p++,l=i+""}if(""!==l){if(Object.prototype.hasOwnProperty.call(n,l)){if(256>l.charCodeAt(0)){for(o=0;g>o;o++)u<<=1,15==m?(m=0,d+=f(u),u=0):m++;for(t=l.charCodeAt(0),o=0;8>o;o++)u=u<<1|1&t,15==m?(m=0,d+=f(u),u=0):m++,t>>=1}else{for(t=1,o=0;g>o;o++)u=u<<1|t,15==m?(m=0,d+=f(u),u=0):m++,t=0;for(t=l.charCodeAt(0),o=0;16>o;o++)u=u<<1|1&t,15==m?(m=0,d+=f(u),u=0):m++,t>>=1}c--,0==c&&(c=Math.pow(2,g),g++),delete n[l]}else for(t=a[l],o=0;g>o;o++)u=u<<1|1&t,15==m?(m=0,d+=f(u),u=0):m++,t>>=1;c--,0==c&&(c=Math.pow(2,g),g++)}for(t=2,o=0;g>o;o++)u=u<<1|1&t,15==m?(m=0,d+=f(u),u=0):m++,t>>=1;for(;;){if(u<<=1,15==m){d+=f(u);break}m++}return d},decompress:function(e){if(null==e)return"";if(""==e)return null;var o,t,r,a,n,i,s,l,c=[],p=4,g=4,d=3,u="",m="",f=LZString._f,h={string:e,val:e.charCodeAt(0),position:32768,index:1};for(t=0;3>t;t+=1)c[t]=t;for(a=0,i=Math.pow(2,2),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;switch(o=a){case 0:for(a=0,i=Math.pow(2,8),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;l=f(a);break;case 1:for(a=0,i=Math.pow(2,16),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;l=f(a);break;case 2:return""}for(c[3]=l,r=m=l;;){if(h.index>h.string.length)return"";for(a=0,i=Math.pow(2,d),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;switch(l=a){case 0:for(a=0,i=Math.pow(2,8),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;c[g++]=f(a),l=g-1,p--;break;case 1:for(a=0,i=Math.pow(2,16),s=1;s!=i;)n=h.val&h.position,h.position>>=1,0==h.position&&(h.position=32768,h.val=h.string.charCodeAt(h.index++)),a|=(n>0?1:0)*s,s<<=1;c[g++]=f(a),l=g-1,p--;break;case 2:return m}if(0==p&&(p=Math.pow(2,d),d++),c[l])u=c[l];else{if(l!==g)return null;u=r+r.charAt(0)}m+=u,c[g++]=r+u.charAt(0),p--,r=u,0==p&&(p=Math.pow(2,d),d++)}}};"undefined"!=typeof module&&null!=module&&(module.exports=LZString);var save=new SaveData;SaveData.prototype.save=function(){console.log(this.base64()),longUrl=window.location.href.split("?")[0]+"?"+this.base64(),jQuery.urlShortener({longUrl:longUrl,success:function(e){alert(e),console.log(e),window.location=e},error:function(e){alert(JSON.stringify(e))}})},SaveData.prototype.base64=function(){return LZString.compressToBase64(this.metadata()+this.drawLog.join(":"))},SaveData.prototype.metadata=function(){var e="";return e+="z"+map.zoom+":",e+="c"+(""+map.getCenter())+":",e=e.replace(/\(/g,"").replace(/\)/g,"").replace(" ","")},SaveData.prototype.add=function(e){this.drawLog.push(e)},google.maps.event.addDomListener(window,"load",initialize);